<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contacts • Frozen Diamond Classic</title>
  <link rel="stylesheet" href="./styles.css" />
</head>

<body class="watermarkPage contactsPage">
  <header class="siteHeader">
    <nav class="nav">
      <a href="./">Home</a>
      <a href="./schedule.html">Schedule/Scores</a>
      <a href="./standings.html">Standings</a>
      <a href="./stats.html">Stats</a>
      <a href="./teams.html">Teams</a>
      <a href="./rules.html">Rules</a>
      <a href="./contacts.html" class="active">Contacts</a>
      <a href="./gallery.html">Gallery</a>
      <a href="./uploads.html">Uploads</a>
    </nav>

    <div class="brandCenter">
      <img src="./logo.png" alt="Frozen Diamond Classic Logo" class="logoImage">
      <h1>Frozen Diamond Classic</h1>
      <div class="tagline">Tournament Central</div>
    </div>
  </header>

  <main class="wrap">
    <section class="docSection">
      <h2>Contacts</h2>
      <p class="muted">Head coaches + GameChanger links.</p>

      <div class="card">
        <div class="cardBody">
          <div id="contactsGrid" class="contactsGrid"></div>
          <p class="muted small" style="margin-top:12px;">
            Tip: Team names link to rosters. GameChanger links open in a new tab.
          </p>
        </div>
      </div>
    </section>
  </main>

  <script src="./data.js"></script>
  <script>
    function safe(v){ return String(v ?? "").trim(); }

    function phoneDigits(phone){
      return safe(phone).replace(/\D/g, "");
    }

    function buildCard(slug, info){
      const teamName = safe(info.name) || slug;
      const teamHref = `./team.html?team=${encodeURIComponent(slug)}`;

      const coachName  = safe(info.coachName);
      const coachEmail = safe(info.coachEmail);
      const coachPhone = safe(info.coachPhone);

      const gcUrl  = safe(info.gcUrl);
      const gcName = safe(info.gcName) || (gcUrl ? "GameChanger" : "");

      const logo = safe(info.logo) || (window.DEFAULT_TEAM_LOGO || "./logo.png");

      const el = document.createElement("div");
      el.className = "contactTile";

      el.innerHTML = `
        <span class="contactAccent" aria-hidden="true"></span>

        <div class="contactTop">
          <img class="contactLogo" src="${logo}" alt="${teamName} logo"
               onerror="this.onerror=null; this.src='./logo.png';">
          <div class="contactTopText">
            <a class="contactTeamLink" href="${teamHref}">${teamName}</a>
            <div class="contactSub muted small">Head Coach</div>
          </div>
        </div>

        <div class="contactBody">
          <div class="contactCoachName">${coachName || "TBD"}</div>

          <div class="contactLinks">
            ${coachPhone ? `<a class="contactLink" href="tel:${phoneDigits(coachPhone)}">${coachPhone}</a>` : ""}
            ${coachEmail ? `<a class="contactLink" href="mailto:${coachEmail}">${coachEmail}</a>` : ""}
          </div>

          ${gcUrl ? `
            <div class="contactGCRow">
              <a class="gcLink" href="${gcUrl}" target="_blank" rel="noopener">
                ${gcName} →
              </a>
            </div>
          ` : ""}
        </div>
      `;

      return el;
    }

    (function init(){
      const grid = document.getElementById("contactsGrid");
      grid.innerHTML = "";

      const infoObj = window.TEAM_INFO || {};
      const entries = Object.entries(infoObj);

      // Sort by team name (or keep your insertion order; change if you prefer)
      entries.sort((a,b) => safe(a[1].name).localeCompare(safe(b[1].name)));

      for (const [slug, info] of entries){
        if (!info) continue;
        grid.appendChild(buildCard(slug, info));
      }

      if (!entries.length){
        grid.innerHTML = `<div class="muted">No TEAM_INFO found in data.js.</div>`;
      }
    })();
  </script>
</body>
</html>
